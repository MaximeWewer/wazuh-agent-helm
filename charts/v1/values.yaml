# Default values for wazuh-agent.

# -- (Required) Wazuh manager IP address or hostname
manager:
  address: ""
  # -- Wazuh manager communication port
  port: 1514
  # -- Communication protocol (tcp or udp)
  protocol: tcp

# -- Agent registration settings
registration:
  # -- Registration server address (defaults to manager.address if empty)
  server: ""
  # -- Registration port
  port: 1515
  # -- (Required) Registration password (or use existingSecret)
  password: ""
  # -- Use an existing secret for authd.pass instead of creating one
  existingSecret: ""
  # -- Key in the existing secret containing the password
  existingSecretKey: ""

# -- Agent name prefix (combined with node name)
agentNamePrefix: "k8s"

# -- Container image configuration
image:
  repository: wazuh/wazuh-agent
  tag: "0.0.0"
  pullPolicy: IfNotPresent

# -- Image pull secrets for private registries
imagePullSecrets: []

# -- Init container image for setup tasks
initImage:
  repository: busybox
  tag: "1.37"
  pullPolicy: IfNotPresent

# -- Pod security context
podSecurityContext:
  fsGroup: 999
  fsGroupChangePolicy: OnRootMismatch

# -- Container security context for Wazuh agent
securityContext:
  runAsUser: 0
  runAsGroup: 0
  allowPrivilegeEscalation: true
  capabilities:
    add: ["SETGID", "SETUID"]

# -- Resource limits and requests
resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# -- Node selector for pod scheduling
nodeSelector: {}

# -- Tolerations for pod scheduling
tolerations:
  - key: node-role.kubernetes.io/control-plane
    effect: NoSchedule
  - key: node-role.kubernetes.io/master
    effect: NoSchedule

# -- Affinity rules for pod scheduling
affinity: {}

# -- Priority class name
priorityClassName: ""

# -- Update strategy for DaemonSet
updateStrategy:
  type: RollingUpdate
  rollingUpdate:
    maxUnavailable: 1

# -- Termination grace period in seconds
terminationGracePeriodSeconds: 20

# -- Additional pod labels
podLabels: {}

# -- Additional pod annotations
podAnnotations: {}

# -- Persistence configuration for Wazuh agent data
# Each path can be configured independently with its own volume type.
# Binaries (bin, lib, ruleset, wodles) come from the image and don't need persistence.
# Supported types: hostPath, emptyDir, pvc
persistence:
  # -- Configuration files (/var/ossec/etc)
  # Contains: ossec.conf, client.keys (agent registration), internal_options.conf
  etc:
    enabled: false
    # -- Volume type: hostPath, emptyDir, or pvc
    # type: hostPath
    # hostPath:
    #  path: /var/lib/wazuh-agent/etc
    #  type: DirectoryOrCreate

    # -- emptyDir configuration
    # type: emptyDir
    # emptyDir:
    #   medium: ""        # "" or "Memory"
    #   sizeLimit: 100Mi

    # -- PVC configuration
    # type: pvc
    # pvc:
    #   storageClass: ""  # Empty for default storage class
    #   accessModes:
    #     - ReadWriteOnce
    #   size: 100Mi

  # -- Agent logs (/var/ossec/logs)
  # Contains: ossec.log, active-responses.log
  logs:
    enabled: false

  # -- Message queues (/var/ossec/queue)
  # Contains: alerts, sockets, fim data, syscollector data
  queue:
    enabled: false

  # -- Runtime data (/var/ossec/var)
  # Contains: pid files, run state. Usually doesn't need persistence.
  var:
    enabled: false

  # -- Active response scripts and logs (/var/ossec/active-response)
  # Contains: active response scripts and execution logs
  activeResponse:
    enabled: false

# -- Extra volume mounts for the wazuh-agent container (host logs, etc.)
extraVolumeMounts: []
  # - name: host-logs
  #   mountPath: /host/var/log
  #   readOnly: true
  # - name: docker-logs
  #   mountPath: /host/var/lib/docker/containers
  #   readOnly: true

# -- Extra volumes definition
extraVolumes: []
  # - name: host-logs
  #   hostPath:
  #     path: /var/log
  #     type: Directory
  # - name: docker-logs
  #   hostPath:
  #     path: /var/lib/docker/containers
  #     type: DirectoryOrCreate

# -- local_internal_options.conf base content
localInternalOptions: |
  wazuh_command.remote_commands=1

# -- Additional ossec.conf entries (raw XML, inserted before closing </ossec_config>)
extraOssecConf: ""

# -- Additional local_internal_options.conf entries
extraLocalInternalOptions: ""

# -- Custom active response scripts
# Scripts will be copied to /var/ossec/active-response/bin/ with proper permissions (755, wazuh:wazuh)
# Example:
#   activeResponseScripts:
#     log-hostname.sh: |
#       #!/bin/bash
#       echo "Hostname: $(hostname)" >> /var/ossec/logs/active-responses.log
activeResponseScripts: {}

# -- ServiceAccount configuration
serviceAccount:
  create: true
  name: ""
  annotations: {}

# -- RBAC configuration
rbac:
  create: true

# -- PodDisruptionBudget configuration
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1

# -- NetworkPolicy configuration
networkPolicy:
  enabled: false
  extraEgress: []
